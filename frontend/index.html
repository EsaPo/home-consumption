<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/svg+xml" href="consumption.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' http://192.168.0.225:2992; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net;">
    <title>Property Consumption Management System</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <h1>üè† Property Consumption Management System</h1>

        <div class="nav-menu">
            <button class="nav-item active" onclick="showPage('properties')">
                üè† Properties
            </button>
            <button class="nav-item" onclick="showPage('heat')">
                üî• Heat Consumption
            </button>
            <button class="nav-item" onclick="showPage('electricity')">
                ‚ö° Electricity Consumption
            </button>
            <button class="nav-item" onclick="showPage('water')">
                üíß Water Consumption
            </button>
        </div>

        <div id="messageContainer"></div>

        <div id="propertiesPage" class="page active">
            <div class="actions">
                <button onclick="property.showAddPropertyForm()" class="primary">‚ûï Add New Property</button>
                <button onclick="property.exportPropertiesToCsv()" class="secondary">‚¨áÔ∏è Export to CSV</button>
            </div>
            <div id="addPropertyForm" class="modal-form hidden">
                <h2>Add New Property</h2>
                <form id="propertyForm">
                    <label for="kiinteistotunnus">Property ID:</label>
                    <input type="text" id="kiinteistotunnus" name="kiinteistotunnus" required>
                    <label for="kiinteisto">Property Name:</label>
                    <input type="text" id="kiinteisto" name="kiinteisto" required>
		    <label for="osoite">Address:</label>
                    <input type="text" id="osoite" name="osoite">
		    <label for="rakennusvuosi">Building year:</label>
		    <input type="text" id="rakennusvuosi" name="rakennusvuosi" required>
		    </br><label for="rakennusmateriaali">Building material:</label>
		    <input type="text" id="rakennusmateriaali" name="rakennusmateriaali">
		    <label for="pintaala">Building area:</label>
		    <input type="text" id="pintaala" name="pintaala">
		    <label for="tilavuus">Building volume:</label>
		    <input type="text" id="tilavuus" name="tilavuus">
		    <label for="tontinpintaala">Plot area:</label>
		    <input type="text" id="tontinpintaala" name="tontinpintaala">
		    </br><label for="omistajanimi">Property Owner:</label>
		    <input type="text" id="omistajanimi" name="omistajanimi" required>
		    <label for="omistajapuh">Owner's phone:</label>
		    <input type="text" id="omistajapuh" name="omistajapuh">
		    <label for="omistajasposti">Owners email:</label>
		    <input type="text" id="omistajasposti" name="omistajasposti">
		    <label for="muuta">Other information:</label>
                    <input type="text" id="muuta" name="muuta">
                    <div class="actions">
                        <button type="submit" class="primary">üíæ Save Property</button>
                        <button type="button" onclick="property.hideAddPropertyForm()" class="secondary">‚ùå Cancel</button>
                    </div>
                </form>
            </div>
            <div class="table-container">
                <p id="propertiesLoadingMessage" class="loading-message hidden">Loading property data...</p>
		<table id="propertiesTable" class="data-table hidden">
		    <thead>
		        <tr>
			    <th>Property Name</th>
			    <th>Address</th>
			    <th>Property ID</th>
			    <th>Building Year</th>
			    <th>Building Material</th>
			    <th>Building Area</th>
			    <th>Building Volume</th>
			    <th>Plot Area</th>
			    <th>Owner Name</th>
			    <th>Owner Phone</th>
			    <th>Owner Email</th>
			    <th>Other Information</th>
			    <th>Actions</th>
			</tr>
		    </thead>
		    <tbody id="propertiesTableBody">
		    </tbody>
		</table>
            </div>
        </div>

        <div id="heatPage" class="page">
            <div class="actions">
                <button onclick="showAddHeatForm()" class="primary">‚ûï Add New Heat Reading</button>
                <button onclick="exportHeatToCsv()" class="secondary">‚¨áÔ∏è Export to CSV</button>
            </div>
            <div id="addHeatForm" class="modal-form hidden">
                <h2>Add Heat Reading</h2>
                <form id="heatForm">
                    <label for="heat_kiinteistotunnus">Property:</label>
                    <select id="heat_kiinteistotunnus" name="kiinteistotunnus" required></select>
                    <label for="heat_vuosi">Year:</label>
                    <input type="number" id="heat_vuosi" name="vuosi" required min="2000" max="2100" value="2023">
                    <label for="heat_kuukausi">Month:</label>
                    <select id="heat_kuukausi" name="kuukausi" required>
                        <option value="Tammi">January</option>
                        <option value="Helmi">February</option>
                        <option value="Maalis">March</option>
                        <option value="Huhti">April</option>
                        <option value="Touko">May</option>
                        <option value="Kes√§">June</option>
                        <option value="Hein√§">July</option>
                        <option value="Elo">August</option>
                        <option value="Syys">September</option>
                        <option value="Loka">October</option>
                        <option value="Marras">November</option>
                        <option value="Joulu">December</option>
                    </select>
                    <label for="heat_lukemapva">Reading Date:</label>
                    <input type="date" id="heat_lukemapva" name="lukemapva" required></br>
                    <label for="heat_lampolukema">Heat Reading (kWh):</label>
                    <input type="number" id="heat_lampolukema" name="lampolukema" step="0.001" required>
                    <label for="heat_virtaamalukema">Flow Meter Reading (m¬≥):</label>
                    <input type="number" id="heat_virtaamalukema" name="virtaamalukema" step="0.01">
                    <label for="heat_muuta">Notes:</label>
                    <textarea id="heat_muuta" name="muuta"></textarea></br>
                    <div class="actions">
                        <button type="submit" class="primary">üíæ Save Reading</button>
                        <button type="button" onclick="hideAddHeatForm()" class="secondary">‚ùå Cancel</button>
                    </div>
                </form>
            </div>
            <div class="chart-container">
                <canvas id="heatChart"></canvas>
            </div>
            <div class="chart-controls">
                <label for="heat-year-select">Select Year:</label>
                <select id="heat-year-select" multiple size="3"></select>
                <label for="showFlowConsumption" style="margin-left: 20px;">
                    <input type="checkbox" id="showFlowConsumption"> Show Flow Consumption
                </label>
            </div>
            <div class="table-container">
                <p id="heatLoadingMessage" class="loading-message hidden">Loading heat data...</p>
                <table id="heatTable" class="data-table hidden">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Address</th>
                            <th>Year</th>
                            <th>Month</th>
                            <th>Reading Date</th>
                            <th>Heat Reading</th>
                            <th>Flow Meter Reading</th>
                            <th>Heat Consumption</th>
                            <th>Flow Meter Consumption</th>
			    <th>Other Information</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="heatTableBody">
                    </tbody>
                </table>
                <div id="heatPagination" class="pagination-controls hidden">
                    <div class="pagination-info">
                        Showing <span id="heatCurrentRange">0-0</span> of <span id="heatTotalItems">0</span> readings
                    </div>
                    <div class="pagination-buttons">
                        <button id="heatPrevBtn" onclick="changeHeatPage(-1)" disabled>‚Üê Previous</button>
                        <div id="heatPageNumbers"></div>
                        <button id="heatNextBtn" onclick="changeHeatPage(1)" disabled>Next ‚Üí</button>
                    </div>
                    <div class="pagination-size">
                        Items per page:
                        <select id="heatPageSize" onchange="changeHeatPageSize()">
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div id="electricityPage" class="page">
            <div class="actions">
                <button onclick="showAddElectricityForm()" class="primary">‚ûï Add New Electricity Reading</button>
                <button onclick="exportElectricityToCsv()" class="secondary">‚¨áÔ∏è Export to CSV</button>
            </div>
            <div id="addElectricityForm" class="modal-form hidden">
                <h2>Add Electricity Reading</h2>
                <form id="electricityForm">
                    <label for="electricity_kiinteistotunnus">Property:</label>
                    <select id="electricity_kiinteistotunnus" name="kiinteistotunnus" required></select>
                    <label for="electricity_vuosi">Year:</label>
                    <input type="number" id="electricity_vuosi" name="vuosi" required min="2000" max="2100" value="2023">
                    <label for="electricity_kuukausi">Month:</label>
                    <select id="electricity_kuukausi" name="kuukausi" required>
                        <option value="Tammi">January</option>
                        <option value="Helmi">February</option>
                        <option value="Maalis">March</option>
                        <option value="Huhti">April</option>
                        <option value="Touko">May</option>
                        <option value="Kes√§">June</option>
                        <option value="Hein√§">July</option>
                        <option value="Elo">August</option>
                        <option value="Syys">September</option>
                        <option value="Loka">October</option>
                        <option value="Marras">November</option>
                        <option value="Joulu">December</option>
                    </select>
                    <label for="electricity_lukemapva">Reading Date:</label>
                    <input type="date" id="electricity_lukemapva" name="lukemapva" required></br>
                    <label for="electricity_sahkolukema">Electricity Reading (kWh):</label>
                    <input type="number" id="electricity_sahkolukema" name="sahkolukema" step="1" required>
                    <label for="electricity_muuta">Notes:</label>
                    <textarea id="electricity_muuta" name="muuta"></textarea></br>
                    <div class="actions">
                        <button type="submit" class="primary">üíæ Save Reading</button>
                        <button type="button" onclick="hideAddElectricityForm()" class="secondary">‚ùå Cancel</button>
                    </div>
                </form>
            </div>
            <div class="chart-container">
                <canvas id="electricityChart"></canvas>
            </div>
            <div class="chart-controls">
                <label for="electricity-year-select">Select Year:</label>
                <select id="electricity-year-select" multiple size="3"></select>
            </div>
            <div class="table-container">
                <p id="electricityLoadingMessage" class="loading-message hidden">Loading electricity data...</p>
                <table id="electricityTable" class="data-table hidden">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Address</th>
                            <th>Year</th>
                            <th>Month</th>
                            <th>Reading Date</th>
                            <th>Electricity Reading</th>
                            <th>Electricity Consumption</th>
                            <th>Other Information</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="electricityTableBody">
                    </tbody>
                </table>
                <div id="electricityPagination" class="pagination-controls hidden">
                    <div class="pagination-info">
                        Showing <span id="electricityCurrentRange">0-0</span> of <span id="electricityTotalItems">0</span> readings
                    </div>
                    <div class="pagination-buttons">
                        <button id="electricityPrevBtn" onclick="changeElectricityPage(-1)" disabled>‚Üê Previous</button>
                        <div id="electricityPageNumbers"></div>
                        <button id="electricityNextBtn" onclick="changeElectricityPage(1)" disabled>Next ‚Üí</button>
                    </div>
                    <div class="pagination-size">
                        Items per page:
                        <select id="electricityPageSize" onchange="changeElectricityPageSize()">
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div id="waterPage" class="page">
            <div class="actions">
                <button onclick="water.showAddWaterForm()" class="primary">‚ûï Add New Water Reading</button>
                <button onclick="water.exportWaterToCsv()" class="secondary">‚¨áÔ∏è Export to CSV</button>
            </div>
            <div id="addWaterForm" class="modal-form hidden">
                <h2>Add Water Reading</h2>
                <form id="waterForm">
                    <label for="water_kiinteistotunnus">Property:</label>
                    <select id="water_kiinteistotunnus" name="kiinteistotunnus" required></select>
                    <label for="water_vuosi">Year:</label>
                    <input type="number" id="water_vuosi" name="vuosi" required min="2000" max="2100" value="2023">
                    <label for="water_kuukausi">Month:</label>
                    <select id="water_kuukausi" name="kuukausi" required>
                        <option value="Tammi">January</option>
                        <option value="Helmi">February</option>
                        <option value="Maalis">March</option>
                        <option value="Huhti">April</option>
                        <option value="Touko">May</option>
                        <option value="Kes√§">June</option>
                        <option value="Hein√§">July</option>
                        <option value="Elo">August</option>
                        <option value="Syys">September</option>
                        <option value="Loka">October</option>
                        <option value="Marras">November</option>
                        <option value="Joulu">December</option>
                    </select>
                    <label for="water_lukemapva">Reading Date:</label>
                    <input type="date" id="water_lukemapva" name="lukemapva" required></br>
                    <label for="water_vesilukema">Water Reading (m¬≥):</label>
                    <input type="number" id="water_vesilukema" name="vesilukema" step="0.0001" required>
                    <label for="water_muuta">Notes:</label>
                    <textarea id="water_muuta" name="muuta"></textarea></br>
                    <div class="actions">
                        <button type="submit" class="primary">üíæ Save Reading</button>
                        <button type="button" onclick="water.hideAddWaterForm()" class="secondary">‚ùå Cancel</button>
                    </div>
                </form>
            </div>
            <div class="chart-container">
                <canvas id="waterChart"></canvas>
            </div>
            <div class="chart-controls">
                <label for="water-year-select">Select Year:</label>
                <select id="water-year-select" multiple size="3"></select>
            </div>
            <div class="table-container">
                <p id="waterLoadingMessage" class="loading-message hidden">Loading water data...</p>
                <table id="waterTable" class="data-table hidden">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Address</th>
                            <th>Year</th>
                            <th>Month</th>
                            <th>Reading Date</th>
                            <th>Water Reading</th>
                            <th>Water Consumption</th>
                            <th>Other Information</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="waterTableBody">
                    </tbody>
                </table>
                <div id="waterPagination" class="pagination-controls hidden">
                    <div class="pagination-info">
                        Showing <span id="waterCurrentRange">0-0</span> of <span id="waterTotalItems">0</span> readings
                    </div>
                    <div class="pagination-buttons">
                        <button id="waterPrevBtn" onclick="changeWaterPage(-1)" disabled>‚Üê Previous</button>
                        <div id="waterPageNumbers"></div>
                        <button id="waterNextBtn" onclick="changeWaterPage(1)" disabled>Next ‚Üí</button>
                    </div>
                    <div class="pagination-size">
                        Items per page:
                        <select id="waterPageSize" onchange="changeWaterPageSize()">
                            <option value="10" selected>10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDeleteModal()">&times;</span>
            <h2>Confirm Delete</h2>
            <p id="deleteMessage">Are you sure you want to delete this item?</p>
            <div id="deleteItemInfo"></div>
            <div class="actions" style="margin-top: 20px;">
                <button onclick="confirmDelete()" class="danger">üóëÔ∏è Delete</button>
                <button onclick="closeDeleteModal()">‚ùå Cancel</button>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
    <script src="property.js"></script>
    <script src="heat.js"></script>
    <script src="electricity.js"></script>
    <script src="water.js"></script>
</body>
</html>
